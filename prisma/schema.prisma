generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model adm {
  id_admin Int    @id @default(autoincrement())
  email    String @unique(map: "email") @db.VarChar(100)
  senha    String @db.VarChar(255)
}

model aluno {
  id_aluno                             Int           @id @default(autoincrement())
  id_professor                         Int
  nome                                 String        @db.VarChar(100)
  cpf                                  String        @unique(map: "cpf") @db.Char(11)
  email                                String        @unique(map: "email") @db.VarChar(100)
  status                               aluno_status? @default(Ativo)
  id_treino_ativo                      Int?
  criado_em                            DateTime      @default(now()) @db.Timestamp(0)
  professor                            professor     @relation(fields: [id_professor], references: [id_professor], map: "fk_aluno_professor")
  treino_aluno_id_treino_ativoTotreino treino?       @relation("aluno_id_treino_ativoTotreino", fields: [id_treino_ativo], references: [id_treino], map: "fk_aluno_treino_ativo")
  treino_treino_id_alunoToaluno        treino[]      @relation("treino_id_alunoToaluno")

  @@index([id_professor], map: "fk_aluno_professor")
  @@index([id_treino_ativo], map: "fk_aluno_treino_ativo")
}

model exercicio {
  id_exercicio     Int                @id @default(autoincrement())
  nome             String             @unique(map: "uq_exercicio_nome") @db.VarChar(100)
  descricao        String?            @db.Text
  grupo_muscular   String?            @db.VarChar(50)
  equipamento      String?            @db.VarChar(100)
  treino_exercicio treino_exercicio[]
}

model professor {
  id_professor Int               @id @default(autoincrement())
  nome         String            @db.VarChar(100)
  cpf          String            @unique(map: "cpf") @db.Char(11)
  email        String            @unique(map: "email") @db.VarChar(100)
  senha        String            @db.VarChar(255)
  status       professor_status? @default(Ativo)
  criado_em    DateTime          @default(now()) @db.Timestamp(0)
  aluno        aluno[]
  treino       treino[]
}

model treino {
  id_treino                           Int                @id @default(autoincrement())
  id_aluno                            Int
  id_professor                        Int
  nome                                String             @db.VarChar(100)
  data_criacao                        DateTime           @default(dbgenerated("(curdate())")) @db.Date
  observacoes                         String?            @db.Text
  aluno_aluno_id_treino_ativoTotreino aluno[]            @relation("aluno_id_treino_ativoTotreino")
  aluno_treino_id_alunoToaluno        aluno              @relation("treino_id_alunoToaluno", fields: [id_aluno], references: [id_aluno], onDelete: Cascade, map: "fk_treino_aluno")
  professor                           professor          @relation(fields: [id_professor], references: [id_professor], map: "fk_treino_prof")
  treino_exercicio                    treino_exercicio[]

  @@index([id_aluno], map: "idx_treino_aluno")
  @@index([id_professor], map: "idx_treino_prof")
}

model treino_exercicio {
  id_treino         Int
  id_exercicio      Int
  ordem             Int?      @default(1)
  series            Int?
  repeticoes        Int?
  carga_kg          Decimal?  @db.Decimal(6, 2)
  descanso_segundos Int?
  exercicio         exercicio @relation(fields: [id_exercicio], references: [id_exercicio], map: "fk_tx_exercicio")
  treino            treino    @relation(fields: [id_treino], references: [id_treino], onDelete: Cascade, map: "fk_tx_treino")

  @@id([id_treino, id_exercicio])
  @@index([id_exercicio], map: "fk_tx_exercicio")
}

enum professor_status {
  Ativo
  Inativo
}

enum aluno_status {
  Ativo
  Inativo
}
